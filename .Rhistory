plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$efficiency),max(mean_fuel$efficiency)),
axes=FALSE, type="b", col=4)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
data = data[-1]
head(data)
attach(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2014:2021) {
mean_data[[i-2013]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$efficiency),max(mean_fuel$efficiency)),
axes=FALSE, type="b", col=4)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
data = data[-1]
head(data)
attach(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2014:2021) {
mean_data[[i-2013]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$efficiency),max(mean_fuel$efficiency)),
axes=FALSE, type="b", col=4)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
data = data[-1]
head(data)
attach(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2014:2021) {
mean_data[[i-2013]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
data = data[-1]
head(data)
attach(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2014:2021) {
mean_data[[i-2013]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomright", legend = c(), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage (kWh/km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomright", legend = c(""), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n", ylab = "average fuel use of dunedin (L)")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage (kWh/km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomright", legend = c(""), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n", ylab = "Average fuel use of dunedin (L)")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage of EV(kWh/km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power usage of EV"), col = c(1, 4), pch = 1)
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n", ylab = "Average fuel use of dunedin (L)")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage of EV(kWh/km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power usage of EV"), col = c(1, 4), pch = 1)
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n", ylab = "Average fuel use of dunedin (L)")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage of EV(kWh/km)",side=4,col=4,line=3, cex = 1)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power usage of EV"), col = c(1, 4), pch = 1)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
data = data[-1]
head(data)
attach(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2014:2021) {
mean_data[[i-2013]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(4,2))
for (i in 2014:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2013]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
eff[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
eff
mean_fuel$power_usage = eff[c(7:12,1:6)]
mean_fuel
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n",
ylab = "Average fuel use of dunedin (L)", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power usage of EV(kWh/km)",side=4,col=4,line=3, cex = 1)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power usage of EV"), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use * mean_fuel$power_usage, type = 'b', xaxt = "n",
ylab = "execpted energy use of EV", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use * mean_fuel$power_usage, type = 'b', xaxt = "n",
ylab = "execpted energy use of EV (L kWh/ km ", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
