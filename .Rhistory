plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power Consumption of EV(kWh/km)",side=4,col=4,line=3, cex = 1)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power Consumption of EV"), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use * mean_fuel$power_usage, type = 'b', xaxt = "n",
ylab = "execpted energy use of EV (L kWh/ km) ", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
temp_data = read.csv('weather data/auckland_motat_ews_data.csv',stringsAsFactors = T)
temp_data$Month = factor(temp_data$Month, levels = unique(temp_data$Month))
temp_data
HDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, HDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in unique(data[data$Year == y,]$Month)) {
#print(paste(y," ", m))
adj_temps = -data[data$Year == y & data$Month == m,]$Temp+temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = factor(mon_sum$Month, levels = month_order)
mon_sum$HDD = as.numeric(mon_sum$HDD)
return(mon_sum)
}
CDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, CDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in levels(data$Month)) {
#print(paste(y," ", m))
adj_temps = data[data$Year == y & data$Month == m,]$Temp-temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = as.factor(mon_sum$Month)
mon_sum$CDD = as.numeric(mon_sum$CDD)
return(mon_sum)
}
HDD_auckland = HDD(temp_data)
#eff = c()
#for (i in 1:12) {
#average efficiency (km/kWh)
#  eff[i] = mean(data[month==i,]$efficiency, na.rm = T)
#}
HDD_auckland
CDD(temp_data, 20)
mean_HDD_auckland = HDD_auckland %>%
group_by(Month) %>%
summarise(average_HDD = mean(HDD))
power = c()
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
power[i] = mean(1/data[month==i & region == "Auckland",]$efficiency, na.rm = T)
eff[i] = mean(data[month==i & region == "Auckland",]$efficiency, na.rm = T)
}
mean_HDD_auckland$power_usage = power
mean_HDD_auckland$efficiency = eff
mean_HDD_auckland
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$power_usage, type = 'b', xaxt = "n",
ylab = "Power Consumption of EV(kWh/km)", xlab = "Month", main = "Auckland EV power consumption and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating day",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topleft", legend = c( "Power Consumption of EV", "Monthly Heating days (Base temp 16°C)"), col = c(1, 4), pch = 1)
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$efficiency, type = 'b', xaxt = "n",
ylab = "Average Efficiency of EV(km/kWh)", xlab = "Month", main = "Auckland EV Efficiency and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating Degree Days (Base temp 16°C)",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topright", legend = c( "Efficiency of EV", "Monthly Heating Degree days"), col = c(1, 4), pch = 1)
avg_eff_HDD_auckland = data[data$year >=2017 & region == "Auckland",] %>%
group_by(year, month) %>%
summarise(efficiency = mean(efficiency))
avg_eff_HDD_auckland$HDD = HDD_auckland$HDD
avg_eff_HDD_auckland
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(data = avg_eff_HDD_auckland,HDD,efficiency)
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(data = avg_eff_HDD_auckland,HDD,efficiency)
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(data = avg_eff_HDD_auckland,HDD,efficiency)
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(data = avg_eff_HDD_auckland,HDD,efficiency)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
#data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
#data = data[-1]
#attach(data)
month_order = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
data$model = as.factor(data$model)
head(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2017:2021) {
mean_data[[i-2016]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(3,2))
for (i in 2017:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2016]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(3,2))
for (i in 2017:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2016]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
power = c()
for (i in 1:12) {
#average power useage (kWh/km)
power[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
mean_fuel$power_usage = power[c(7:12,1:6)]
mean_fuel
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n",
ylab = "Average fuel use of dunedin (L)", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power Consumption of EV(kWh/km)",side=4,col=4,line=3, cex = 1)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power Consumption of EV"), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use * mean_fuel$power_usage, type = 'b', xaxt = "n",
ylab = "execpted energy use of EV (L kWh/ km) ", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
temp_data = read.csv('weather data/auckland_motat_ews_data.csv',stringsAsFactors = T)
temp_data$Month = factor(temp_data$Month, levels = unique(temp_data$Month))
temp_data
HDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, HDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in unique(data[data$Year == y,]$Month)) {
#print(paste(y," ", m))
adj_temps = -data[data$Year == y & data$Month == m,]$Temp+temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = factor(mon_sum$Month, levels = month_order)
mon_sum$HDD = as.numeric(mon_sum$HDD)
return(mon_sum)
}
CDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, CDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in levels(data$Month)) {
#print(paste(y," ", m))
adj_temps = data[data$Year == y & data$Month == m,]$Temp-temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = as.factor(mon_sum$Month)
mon_sum$CDD = as.numeric(mon_sum$CDD)
return(mon_sum)
}
HDD_auckland = HDD(temp_data)
#eff = c()
#for (i in 1:12) {
#average efficiency (km/kWh)
#  eff[i] = mean(data[month==i,]$efficiency, na.rm = T)
#}
HDD_auckland
CDD(temp_data, 20)
mean_HDD_auckland = HDD_auckland %>%
group_by(Month) %>%
summarise(average_HDD = mean(HDD))
power = c()
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
power[i] = mean(1/data[month==i & region == "Auckland",]$efficiency, na.rm = T)
eff[i] = mean(data[month==i & region == "Auckland",]$efficiency, na.rm = T)
}
mean_HDD_auckland$power_usage = power
mean_HDD_auckland$efficiency = eff
mean_HDD_auckland
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$power_usage, type = 'b', xaxt = "n",
ylab = "Power Consumption of EV(kWh/km)", xlab = "Month", main = "Auckland EV power consumption and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating day",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topleft", legend = c( "Power Consumption of EV", "Monthly Heating days (Base temp 16°C)"), col = c(1, 4), pch = 1)
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$efficiency, type = 'b', xaxt = "n",
ylab = "Average Efficiency of EV(km/kWh)", xlab = "Month", main = "Auckland EV Efficiency and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating Degree Days (Base temp 16°C)",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topright", legend = c( "Efficiency of EV", "Monthly Heating Degree days"), col = c(1, 4), pch = 1)
avg_eff_HDD_auckland = data[data$year >=2017 & region == "Auckland",] %>%
group_by(year, month) %>%
summarise(efficiency = mean(efficiency))
avg_eff_HDD_auckland$HDD = HDD_auckland$HDD
avg_eff_HDD_auckland
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(data = avg_eff_HDD_auckland,x = "HDD",y = "efficiency")
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(avg_eff_HDD_auckland$HDD,avg_eff_HDD_auckland$efficiency)
abline(all_lm)
plot(all_lm)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
#data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
#data = data[-1]
#attach(data)
month_order = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
data$model = as.factor(data$model)
head(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2017:2021) {
mean_data[[i-2016]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=9, fig.height=5)
library(dplyr)
library(ggplot2)
library(tidyr)
#data = read.csv('Ftf Efficiency Dataset/ftf_ev_efficiency_distance_models_20211006_v1.0.csv')
#data = data[-1]
attach(data)
month_order = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
data$model = as.factor(data$model)
head(data)
str(data)
summary(data)
data %>%
group_by(year) %>%
summarise(count = n_distinct(vehicle))
data %>%
group_by(region) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
mean_data = list()
for (i in 2017:2021) {
mean_data[[i-2016]] = data[year == i,] %>%
group_by(month) %>%
summarise(mean_kwh = mean(kwh), mean_dist = mean(distance), median_kwh = median(kwh), median_dist = median(distance), mean_ef = mean(efficiency))
}
par(mfrow=c(3,2))
for (i in 2017:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2016]])
plot(cur_year$month, cur_year$mean_kwh, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_kwh,cur_year$median_kwh)),max(c(cur_year$mean_kwh,cur_year$median_kwh))))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
par(new=TRUE)
plot(cur_year$month, cur_year$mean_dist, xlab="", ylab="", xlim = c(1,12),
ylim = c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
axes=FALSE, type="b", col=4)
mtext("Distance travelled (km)",side=4,col=4,line=3, cex = 0.7)
axis(4, ylim=c(min(c(cur_year$mean_dist,cur_year$median_dist)),max(c(cur_year$mean_dist,cur_year$median_dist))),
col=4,col.axis=4)
legend("topright", legend = c("Mean KWh", "Median kWh", "Mean Distance"), col = c(1:2,4), pch = 1)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = kwh)) + geom_density(alpha = 0.5, adjust = 1)
#ggplot(data = patient, aes(x=age))+ geom_histogram(binwidth =10, color = "peachpuff3", fill = "hotpink") + xlab("age (years)") + ggtitle("histogram of patient Age") + theme_dark() + theme(tex = element_text(size = 20))
par(mfrow=c(3,2))
for (i in 2017:2021) {
par(mar = c(4, 4, 2, 4))
cur_year = data.frame(mean_data[[i-2016]])
plot(cur_year$month, cur_year$mean_ef, type = 'b', main = i, xlab = "Month", ylab = "kWh", xlim = c(1,12))
points(cur_year$month, cur_year$median_kwh, type = 'b', col = 2)
}
ggplot(data = data[year == 2018 & month == 6,], aes(x = efficiency)) + geom_density(alpha = 0.5, adjust = 1)
fuel_data = read.csv('Dunedin Fuel research/Dunedin fuel usage.csv')
head(fuel_data)
fuel_data$ï..month = factor(fuel_data$ï..month, levels = fuel_data$ï..month)
plot(as.numeric(fuel_data$ï..month), fuel_data[,3], type = 'b', col = 1 ,xaxt = "n",
ylim = c(min(fuel_data[,3:8]),max(fuel_data[,3:8])))
for (i in 3:8) {
points(as.numeric(fuel_data$ï..month), fuel_data[,i], type = 'b', col = i-2 ,xaxt = "n")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
}
mean_fuel = fuel_data %>%
gather(key = "year", value = "Fuel_used", 3:8) %>%
group_by(ï..month) %>%
summarise(average_fuel_use = mean(Fuel_used))
mean_fuel
power = c()
for (i in 1:12) {
#average power useage (kWh/km)
power[i] = mean(1/data[month==i,]$efficiency, na.rm = T)
}
mean_fuel$power_usage = power[c(7:12,1:6)]
mean_fuel
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use, type = 'b', xaxt = "n",
ylab = "Average fuel use of dunedin (L)", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
par(new=TRUE)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$power_usage, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
axes=FALSE, type="b", col=4)
mtext("Power Consumption of EV(kWh/km)",side=4,col=4,line=3, cex = 1)
axis(4, ylim=c(min(mean_fuel$power_usage),max(mean_fuel$power_usage)),
col=4,col.axis=4)
legend("bottomleft", legend = c("Average fuel use of dunedin", "Power Consumption of EV"), col = c(1, 4), pch = 1)
plot(as.numeric(mean_fuel$ï..month), mean_fuel$average_fuel_use * mean_fuel$power_usage, type = 'b', xaxt = "n",
ylab = "execpted energy use of EV (L kWh/ km) ", xlab = "month")
axis(1, labels = as.character(fuel_data$ï..month), at = as.numeric(fuel_data$ï..month))
temp_data = read.csv('weather data/auckland_motat_ews_data.csv',stringsAsFactors = T)
temp_data$Month = factor(temp_data$Month, levels = unique(temp_data$Month))
temp_data
HDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, HDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in unique(data[data$Year == y,]$Month)) {
#print(paste(y," ", m))
adj_temps = -data[data$Year == y & data$Month == m,]$Temp+temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = factor(mon_sum$Month, levels = month_order)
mon_sum$HDD = as.numeric(mon_sum$HDD)
return(mon_sum)
}
CDD = function (data, temp = 16) {
mon_sum = data.frame(Year = NA, Month = NA, CDD = NA)[-1,]
for (y in min(data$Year):max(data$Year)){
for (m in levels(data$Month)) {
#print(paste(y," ", m))
adj_temps = data[data$Year == y & data$Month == m,]$Temp-temp
#print(sum(adj_temps*(adj_temps > 0))/24)
mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)
}
}
mon_sum$Year = as.factor(mon_sum$Year)
mon_sum$Month = as.factor(mon_sum$Month)
mon_sum$CDD = as.numeric(mon_sum$CDD)
return(mon_sum)
}
HDD_auckland = HDD(temp_data)
#eff = c()
#for (i in 1:12) {
#average efficiency (km/kWh)
#  eff[i] = mean(data[month==i,]$efficiency, na.rm = T)
#}
HDD_auckland
CDD(temp_data, 20)
mean_HDD_auckland = HDD_auckland %>%
group_by(Month) %>%
summarise(average_HDD = mean(HDD))
power = c()
eff = c()
for (i in 1:12) {
#average power useage (kWh/km)
power[i] = mean(1/data[month==i & region == "Auckland",]$efficiency, na.rm = T)
eff[i] = mean(data[month==i & region == "Auckland",]$efficiency, na.rm = T)
}
mean_HDD_auckland$power_usage = power
mean_HDD_auckland$efficiency = eff
mean_HDD_auckland
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$power_usage, type = 'b', xaxt = "n",
ylab = "Power Consumption of EV(kWh/km)", xlab = "Month", main = "Auckland EV power consumption and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating day",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topleft", legend = c( "Power Consumption of EV", "Monthly Heating days (Base temp 16°C)"), col = c(1, 4), pch = 1)
par(mar = c(4, 4, 2, 4))
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$efficiency, type = 'b', xaxt = "n",
ylab = "Average Efficiency of EV(km/kWh)", xlab = "Month", main = "Auckland EV Efficiency and Monthly Heating Days by Month")
axis(1, labels = as.character(mean_HDD_auckland$Month), at = as.numeric(mean_HDD_auckland$Month))
par(new=TRUE)
plot(as.numeric(mean_HDD_auckland$Month), mean_HDD_auckland$average_HDD, xlab="", ylab="", xlim = c(1,12),
ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
axes=FALSE, type="b", col=4)
mtext("Average Monthly Heating Degree Days (Base temp 16°C)",side=4,col=4,line=2, cex = 1)
axis(4, ylim=c(min(mean_HDD_auckland$average_HDD),max(mean_HDD_auckland$average_HDD)),
col=4,col.axis=4)
legend("topright", legend = c( "Efficiency of EV", "Monthly Heating Degree days"), col = c(1, 4), pch = 1)
avg_eff_HDD_auckland = data[data$year >=2017 & region == "Auckland",] %>%
group_by(year, month) %>%
summarise(efficiency = mean(efficiency))
avg_eff_HDD_auckland$HDD = HDD_auckland$HDD
avg_eff_HDD_auckland
all_lm = lm(data = avg_eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(avg_eff_HDD_auckland$HDD,avg_eff_HDD_auckland$efficiency)
abline(all_lm)
plot(all_lm)
auckland_model_count = data[region == "Auckland",] %>%
group_by(model) %>%
summarise(count =  n_distinct(vehicle)) %>%
arrange(-count)
auckland_model_count
eff_HDD_auckland = data[data$year >=2017 & region == "Auckland",]
#-2 just to check that values have in inputted correctly
eff_HDD_auckland$HDD = rep(-2, nrow(eff_HDD_auckland))
for (y in min(eff_HDD_auckland$year):max(eff_HDD_auckland$year)){
for (m in unique(eff_HDD_auckland[eff_HDD_auckland$year == y,]$month)) {
eff_HDD_auckland[eff_HDD_auckland$year == y & eff_HDD_auckland$month == m,]$HDD = HDD_auckland$HDD[HDD_auckland$Year == y & as.numeric(HDD_auckland$Month) == m]
}
}
eff_HDD_auckland$model = factor(eff_HDD_auckland$model, levels = auckland_model_count$model)
eff_HDD_auckland
all_lm = lm(data = eff_HDD_auckland,efficiency~HDD)
summary(all_lm)
plot(eff_HDD_auckland$HDD,eff_HDD_auckland$efficiency)
abline(all_lm)
plot(all_lm)
all_mdl_lm = lm(data = eff_HDD_auckland, efficiency~HDD+model )
summary(all_mdl_lm)
plot(eff_HDD_auckland$HDD,eff_HDD_auckland$efficiency, col = eff_HDD_auckland$model)
abline(all_mdl_lm)
plot(all_mdl_lm)
anova(all_lm,all_mdl_lm)
