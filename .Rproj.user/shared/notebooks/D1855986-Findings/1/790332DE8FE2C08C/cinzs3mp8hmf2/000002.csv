"0","HDD = function (data, temp = 16) {"
"0","  mon_sum = data.frame(Year = NA, Month = NA, HDD = NA)[-1,]"
"0","  for (y in min(data$Year):max(data$Year)){"
"0","    for (m in min(data[data$Year == y,]$Month):max(data[data$Year == y,]$Month)) {"
"0","      #print(paste(y,"" "", m))"
"0","      adj_temps = -data[data$Year == y & data$Month == m,]$Temp+temp"
"0","      #print(sum(adj_temps*(adj_temps > 0))/24)"
"0","      mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)"
"0","    }"
"0","  }"
"0","  mon_sum$City = data$City[1]"
"0","  return(mon_sum)"
"0","}"
"0",""
"0","CDD = function (data, temp = 16) {"
"0","  mon_sum = data.frame(Year = NA, Month = NA, CDD = NA)[-1,]"
"0","  for (y in min(data$Year):max(data$Year)){"
"0","    for (m in min(data[data$Year == y,]$Month):max(data[data$Year == y,]$Month)) {"
"0","      #print(paste(y,"" "", m))"
"0","      adj_temps = data[data$Year == y & data$Month == m,]$Temp-temp"
"0","      #print(sum(adj_temps*(adj_temps > 0))/24)"
"0","      mon_sum[nrow(mon_sum) + 1,] = c(y,m, sum(adj_temps*(adj_temps > 0))/24)"
"0",""
"0","    }"
"0","  }"
"0","  mon_sum$City = data$City[1]"
"0",""
"0","  return(mon_sum)"
"0","}"
"0",""
"0","yearly_line = function(period = 12, count = 10) {"
"0","  for (i in 1:count) {"
"0","    abline(v = i*period, lty = 3)"
"0","  }"
"0","}"
